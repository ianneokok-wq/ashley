<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Interactive Picture Book</title>
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: 'Comic Sans MS', 'Chalkboard SE', cursive;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      perspective: 2000px;
    }

    .book-container {
      width: 90%;
      max-width: 800px;
      height: 80%;
      max-height: 600px;
      position: relative;
    }

    .book {
      width: 100%;
      height: 100%;
      position: relative;
    }

    .book-cover {
      position: absolute;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, #8B4513 0%, #A0522D 100%);
      border-radius: 15px;
      box-shadow: 
        5px 5px 20px rgba(0, 0, 0, 0.3),
        inset -5px 0 10px rgba(0, 0, 0, 0.2);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 40px;
      border: 8px solid #654321;
      cursor: pointer;
      transition: opacity 0.5s ease, transform 0.5s ease;
      z-index: 10;
    }

    .book-cover.opened {
      opacity: 0;
      transform: scale(0.95);
      pointer-events: none;
    }

    .cover-title {
      font-size: 48px;
      font-weight: bold;
      color: #FFD700;
      text-align: center;
      text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.5);
      margin-bottom: 20px;
    }

    .cover-decoration {
      width: 200px;
      height: 200px;
      margin: 20px 0;
    }

    .cover-subtitle {
      font-size: 20px;
      color: #FFF8DC;
      text-align: center;
      font-style: italic;
    }

    .pages-container {
      position: absolute;
      width: 100%;
      height: 100%;
      background: #FFF8F0;
      border-radius: 10px;
      box-shadow: 3px 3px 15px rgba(0, 0, 0, 0.2);
      display: flex;
      flex-direction: column;
      overflow: hidden;
      z-index: 1;
    }

    .page-content {
      flex: 1;
      position: relative;
      overflow: hidden;
    }

    .page {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 60px 40px;
      opacity: 0;
      transform: translateX(50px);
      transition: opacity 0.5s ease, transform 0.5s ease;
      pointer-events: none;
      background: #FFF8F0;
    }

    .page.active {
      opacity: 1;
      transform: translateX(0);
      pointer-events: auto;
    }

    .page-illustration {
      width: 90%;
      max-width: 350px;
      height: 50%;
      margin-bottom: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1));
    }

    .page-text {
      font-size: 22px;
      text-align: center;
      color: #333;
      line-height: 1.8;
      max-width: 600px;
    }

    .page-number {
      position: absolute;
      bottom: 20px;
      right: 30px;
      font-size: 16px;
      color: #999;
      font-style: italic;
    }

    .navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px 30px;
      background: linear-gradient(to bottom, rgba(255, 248, 240, 0.5), rgba(255, 248, 240, 1));
      border-top: 2px solid #E8DCC8;
    }

    .nav-button {
      background: linear-gradient(135deg, #8B4513 0%, #A0522D 100%);
      color: white;
      border: none;
      padding: 12px 28px;
      border-radius: 25px;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      font-family: 'Comic Sans MS', 'Chalkboard SE', cursive;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    .nav-button:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(139, 69, 19, 0.4);
    }

    .nav-button:active:not(:disabled) {
      transform: translateY(0);
    }

    .nav-button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
      transform: none;
    }

    .page-indicator {
      font-size: 18px;
      color: #8B4513;
      font-weight: bold;
    }

    svg {
      width: 100%;
      height: 100%;
    }



    .open-instruction {
      position: absolute;
      bottom: -50px;
      left: 50%;
      transform: translateX(-50%);
      color: white;
      font-size: 16px;
      text-align: center;
      opacity: 1;
      transition: opacity 0.3s ease;
      pointer-events: none;
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
    }

    .open-instruction.hidden {
      opacity: 0;
    }

    @keyframes pulse {
      0%, 100% { transform: translateX(-50%) scale(1); }
      50% { transform: translateX(-50%) scale(1.05); }
    }

    .open-instruction:not(.hidden) {
      animation: pulse 2s infinite;
    }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="book-container">
   <div class="book">
    <div class="book-cover" id="book-cover" onclick="openBook()">
     <h1 class="cover-title" id="cover-title">My Picture Book</h1>
     <div class="cover-decoration">
      <svg viewbox="0 0 200 200"><circle cx="100" cy="100" r="80" fill="#FFD700" opacity="0.3" /> <path d="M 100 40 L 110 70 L 140 75 L 115 95 L 125 125 L 100 110 L 75 125 L 85 95 L 60 75 L 90 70 Z" fill="#FFD700" /> <circle cx="60" cy="60" r="12" fill="#FFD700" opacity="0.5" /> <circle cx="140" cy="70" r="10" fill="#FFD700" opacity="0.5" /> <circle cx="70" cy="140" r="8" fill="#FFD700" opacity="0.5" /> <circle cx="130" cy="130" r="11" fill="#FFD700" opacity="0.5" />
      </svg>
     </div>
     <p class="cover-subtitle">Click to Open</p>
    </div>
    <div class="pages-container">
     <div class="page-content">
      <div class="page active" data-page="1">
       <div class="page-illustration">
        <svg viewbox="0 0 200 200"><circle cx="100" cy="60" r="35" fill="#FFD93D" /> <circle cx="90" cy="55" r="5" fill="#333" /> <circle cx="110" cy="55" r="5" fill="#333" /> <path d="M 85 70 Q 100 80 115 70" stroke="#333" stroke-width="3" fill="none" stroke-linecap="round" /> <ellipse cx="100" cy="130" rx="50" ry="60" fill="#FF6B6B" /> <rect x="75" y="100" width="10" height="40" fill="#FFD93D" /> <rect x="115" y="100" width="10" height="40" fill="#FFD93D" /> <rect x="85" y="180" width="12" height="20" fill="#4ECDC4" /> <rect x="103" y="180" width="12" height="20" fill="#4ECDC4" />
        </svg>
       </div>
       <p class="page-text" id="page-1-text">Once upon a time, there was a happy little person who loved adventures!</p><span class="page-number">1</span>
      </div>
      <div class="page" data-page="2">
       <div class="page-illustration">
        <svg viewbox="0 0 200 200"><rect x="50" y="80" width="100" height="80" fill="#A0522D" /> <rect x="80" y="120" width="40" height="40" fill="#8B4513" /> <path d="M 50 80 L 100 30 L 150 80 Z" fill="#FF6B6B" /> <rect x="70" y="100" width="20" height="25" fill="#87CEEB" /> <rect x="110" y="100" width="20" height="25" fill="#87CEEB" /> <circle cx="40" cy="40" r="20" fill="#FFD93D" /> <path d="M 20 150 Q 40 145 60 150 Q 80 155 100 150 Q 120 145 140 150 Q 160 155 180 150" stroke="#90EE90" stroke-width="8" fill="none" stroke-linecap="round" />
        </svg>
       </div>
       <p class="page-text" id="page-2-text">They lived in a cozy little house with a bright red roof and sunny windows.</p><span class="page-number">2</span>
      </div>
      <div class="page" data-page="3">
       <div class="page-illustration">
        <svg viewbox="0 0 200 200"><rect x="20" y="100" width="160" height="100" fill="#87CEEB" /> <circle cx="60" cy="130" r="15" fill="#FF6B6B" opacity="0.6" /> <circle cx="100" cy="125" r="18" fill="#FFD93D" opacity="0.6" /> <circle cx="140" cy="135" r="12" fill="#4ECDC4" opacity="0.6" /> <circle cx="80" cy="160" r="13" fill="#FF69B4" opacity="0.6" /> <circle cx="120" cy="155" r="16" fill="#98FB98" opacity="0.6" /> <rect x="50" y="180" width="100" height="5" fill="#8B4513" /> <path d="M 30 50 Q 50 30 70 50 Q 90 70 110 50 Q 130 30 150 50 Q 170 70 190 50" stroke="#90EE90" stroke-width="20" fill="none" stroke-linecap="round" />
        </svg>
       </div>
       <p class="page-text" id="page-3-text">One day, they discovered a magical garden full of colorful floating bubbles!</p><span class="page-number">3</span>
      </div>
      <div class="page" data-page="4">
       <div class="page-illustration">
        <svg viewbox="0 0 200 200"><rect x="0" y="0" width="200" height="200" fill="#191970" /> <circle cx="100" cy="100" r="40" fill="#FFD93D" /> <path d="M 100 60 L 110 80 L 130 75 L 115 90 L 125 110 L 100 100 L 75 110 L 85 90 L 70 75 L 90 80 Z" fill="#FFA500" /> <circle cx="50" cy="50" r="8" fill="#FFFFFF" /> <path d="M 50 42 L 52 48 L 58 48 L 53 52 L 55 58 L 50 54 L 45 58 L 47 52 L 42 48 L 48 48 Z" fill="#FFFFFF" /> <circle cx="150" cy="60" r="6" fill="#FFFFFF" /> <path d="M 150 54 L 151 58 L 155 58 L 152 61 L 153 65 L 150 62 L 147 65 L 148 61 L 145 58 L 149 58 Z" fill="#FFFFFF" /> <circle cx="140" cy="140" r="7" fill="#FFFFFF" /> <path d="M 140 133 L 141 138 L 146 138 L 142 141 L 144 146 L 140 143 L 136 146 L 138 141 L 134 138 L 139 138 Z" fill="#FFFFFF" /> <circle cx="30" cy="120" r="5" fill="#FFFFFF" /> <circle cx="170" cy="130" r="4" fill="#FFFFFF" />
        </svg>
       </div>
       <p class="page-text" id="page-4-text">The stars came out to play, twinkling and dancing in the night sky.</p><span class="page-number">4</span>
      </div>
      <div class="page" data-page="5">
       <div class="page-illustration">
        <svg viewbox="0 0 200 200"><rect x="0" y="120" width="200" height="80" fill="#87CEEB" /> <path d="M 30 180 Q 60 160 90 180 Q 120 200 150 180 Q 180 160 200 180 L 200 200 L 0 200 Z" fill="#90EE90" /> <rect x="90" y="120" width="20" height="60" fill="#8B4513" /> <circle cx="100" cy="80" r="40" fill="#228B22" /> <circle cx="85" cy="65" r="25" fill="#32CD32" /> <circle cx="115" cy="70" r="30" fill="#32CD32" /> <circle cx="100" cy="50" r="20" fill="#32CD32" /> <circle cx="60" cy="40" r="25" fill="#FFD93D" /> <path d="M 55 40 L 50 30 M 65 40 L 70 30 M 60 35 L 60 25 M 55 45 L 45 50 M 65 45 L 75 50" stroke="#FFA500" stroke-width="3" stroke-linecap="round" /> <path d="M 20 100 Q 30 95 40 100 T 60 100 T 80 100" stroke="#FF69B4" stroke-width="3" fill="none" /> <path d="M 120 95 Q 130 90 140 95 T 160 95 T 180 95" stroke="#FF69B4" stroke-width="3" fill="none" />
        </svg>
       </div>
       <p class="page-text" id="page-5-text">And they all lived happily ever after, under the warm sunshine. The End! üåà</p><span class="page-number">5</span>
      </div>
     </div>
     <nav class="navigation"><button class="nav-button" id="prev-btn" onclick="previousPage()">‚Üê Previous</button>
      <div class="page-indicator"><span id="current-page">1</span> / <span id="total-pages">5</span>
      </div><button class="nav-button" id="next-btn" onclick="nextPage()">Next ‚Üí</button>
     </nav>
    </div>
   </div>
   <div class="open-instruction" id="open-instruction">
    üìñ Click the book cover to open and start reading!
   </div>
  </div>
  <script>
    const defaultConfig = {
      book_title: "My Picture Book",
      page_1_text: "Once upon a time, there was a happy little person who loved adventures!",
      page_2_text: "They lived in a cozy little house with a bright red roof and sunny windows.",
      page_3_text: "One day, they discovered a magical garden full of colorful floating bubbles!",
      page_4_text: "The stars came out to play, twinkling and dancing in the night sky.",
      page_5_text: "And they all lived happily ever after, under the warm sunshine. The End! üåà",
      background_color: "#667eea",
      cover_color: "#8B4513",
      page_color: "#FFF8F0",
      text_color: "#333333",
      button_color: "#8B4513",
      font_family: "Comic Sans MS",
      font_size: 16
    };

    let currentPage = 1;
    const totalPages = 5;
    let isBookOpen = false;

    async function onConfigChange(config) {
      const coverTitle = document.getElementById('cover-title');
      const customFont = config.font_family || defaultConfig.font_family;
      const baseFontSize = config.font_size || defaultConfig.font_size;
      const baseFontStack = 'Chalkboard SE, cursive';
      
      coverTitle.textContent = config.book_title || defaultConfig.book_title;
      coverTitle.style.fontFamily = `${customFont}, ${baseFontStack}`;
      coverTitle.style.fontSize = `${baseFontSize * 3}px`;
      
      document.body.style.background = `linear-gradient(135deg, ${config.background_color || defaultConfig.background_color} 0%, #764ba2 100%)`;
      
      const bookCover = document.querySelector('.book-cover');
      bookCover.style.background = `linear-gradient(135deg, ${config.cover_color || defaultConfig.cover_color} 0%, #A0522D 100%)`;
      
      const pagesContainer = document.querySelector('.pages-container');
      pagesContainer.style.background = config.page_color || defaultConfig.page_color;
      
      const pages = document.querySelectorAll('.page');
      pages.forEach(page => {
        page.style.background = config.page_color || defaultConfig.page_color;
      });
      
      for (let i = 1; i <= totalPages; i++) {
        const pageText = document.getElementById(`page-${i}-text`);
        if (pageText) {
          pageText.textContent = config[`page_${i}_text`] || defaultConfig[`page_${i}_text`];
          pageText.style.fontFamily = `${customFont}, ${baseFontStack}`;
          pageText.style.fontSize = `${baseFontSize * 1.375}px`;
          pageText.style.color = config.text_color || defaultConfig.text_color;
        }
      }
      
      const navButtons = document.querySelectorAll('.nav-button');
      navButtons.forEach(button => {
        button.style.background = `linear-gradient(135deg, ${config.button_color || defaultConfig.button_color} 0%, #A0522D 100%)`;
        button.style.fontFamily = `${customFont}, ${baseFontStack}`;
        button.style.fontSize = `${baseFontSize}px`;
      });
      
      const pageIndicator = document.querySelector('.page-indicator');
      pageIndicator.style.fontFamily = `${customFont}, ${baseFontStack}`;
      pageIndicator.style.fontSize = `${baseFontSize * 1.125}px`;
      pageIndicator.style.color = config.button_color || defaultConfig.button_color;
    }

    function openBook() {
      if (!isBookOpen) {
        document.getElementById('book-cover').classList.add('opened');
        document.getElementById('open-instruction').classList.add('hidden');
        isBookOpen = true;
      }
    }

    function updatePageDisplay() {
      const pages = document.querySelectorAll('.page');
      pages.forEach((page, index) => {
        if (index + 1 === currentPage) {
          page.classList.add('active');
        } else {
          page.classList.remove('active');
        }
      });

      document.getElementById('current-page').textContent = currentPage;
      document.getElementById('prev-btn').disabled = currentPage === 1;
      document.getElementById('next-btn').disabled = currentPage === totalPages;
    }

    function nextPage() {
      if (currentPage < totalPages) {
        currentPage++;
        updatePageDisplay();
      }
    }

    function previousPage() {
      if (currentPage > 1) {
        currentPage--;
        updatePageDisplay();
      }
    }

    if (window.elementSdk) {
      window.elementSdk.init({
        defaultConfig,
        onConfigChange,
        mapToCapabilities: (config) => ({
          recolorables: [
            {
              get: () => config.background_color || defaultConfig.background_color,
              set: (value) => {
                config.background_color = value;
                window.elementSdk.setConfig({ background_color: value });
              }
            },
            {
              get: () => config.cover_color || defaultConfig.cover_color,
              set: (value) => {
                config.cover_color = value;
                window.elementSdk.setConfig({ cover_color: value });
              }
            },
            {
              get: () => config.page_color || defaultConfig.page_color,
              set: (value) => {
                config.page_color = value;
                window.elementSdk.setConfig({ page_color: value });
              }
            },
            {
              get: () => config.text_color || defaultConfig.text_color,
              set: (value) => {
                config.text_color = value;
                window.elementSdk.setConfig({ text_color: value });
              }
            },
            {
              get: () => config.button_color || defaultConfig.button_color,
              set: (value) => {
                config.button_color = value;
                window.elementSdk.setConfig({ button_color: value });
              }
            }
          ],
          borderables: [],
          fontEditable: {
            get: () => config.font_family || defaultConfig.font_family,
            set: (value) => {
              config.font_family = value;
              window.elementSdk.setConfig({ font_family: value });
            }
          },
          fontSizeable: {
            get: () => config.font_size || defaultConfig.font_size,
            set: (value) => {
              config.font_size = value;
              window.elementSdk.setConfig({ font_size: value });
            }
          }
        }),
        mapToEditPanelValues: (config) => new Map([
          ["book_title", config.book_title || defaultConfig.book_title],
          ["page_1_text", config.page_1_text || defaultConfig.page_1_text],
          ["page_2_text", config.page_2_text || defaultConfig.page_2_text],
          ["page_3_text", config.page_3_text || defaultConfig.page_3_text],
          ["page_4_text", config.page_4_text || defaultConfig.page_4_text],
          ["page_5_text", config.page_5_text || defaultConfig.page_5_text]
        ])
      });
    }

    updatePageDisplay();
  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a076d4dc376fec7',t:'MTc2MzQ2ODQ4MC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>